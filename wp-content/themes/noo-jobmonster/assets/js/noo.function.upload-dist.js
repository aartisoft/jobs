!function(u){u.fn.noo_upload=function(i){var e={max_file_size:"2mb",runtimes:"html5,flash,html4",multipart:!0,urlstream_upload:!0,max_files:0,upload_enabled:!0,multi_upload:!1,url:nooUpload.url,delete_url:nooUpload.delete_url,flash_swf_url:nooUpload.flash_swf_url,resize:{}},a=(i=u.extend(e,i)).flash_swf_url,l=i.tag_thumb,o=u("#"+l),d=i.input_name,n=i.multi_upload,t=new plupload.Uploader({browse_button:i.browse_button,file_data_name:"aaiu_upload_file",multi_selection:i.multi_upload,url:i.url,flash_swf_url:a,filters:[{title:"extensions",extensions:"jpg,jpeg,gif,png"}],resize:i.resize,views:{thumb:!0},init:{PostInit:function(){o.innerHTML=""},FilesAdded:function(e,a){plupload.each(a,function(e){!1===n?u("#"+i.browse_button).parent().find(".noo_upload-status").get(0).innerHTML='<div id="'+e.id+'">'+e.name+" ("+plupload.formatSize(e.size)+") <b></b></div>":u("#"+i.browse_button).parent().find(".noo_upload-status").get(0).innerHTML+='<div id="'+e.id+'">'+e.name+" ("+plupload.formatSize(e.size)+") <b></b></div>"}),t.start()},UploadProgress:function(e,a){u("#"+a.id)&&(u("#"+a.id).find("b").get(0).innerHTML="<span>"+a.percent+"%</span>")},Error:function(e,a){!1===n?o.html("\nError #"+a.code+": "+a.message):o.get(0).innerHTML+="\nError #"+a.code+": "+a.message},FileUploaded:function(e,a,i){var l=u.parseJSON(i.response);if(u("#"+a.id).remove(),l.success){var t=l.image_id+",";o.find(".noo-upload-value").val(t),!1===n?o.append('<div class="image-upload-thumb"><img width="150" src="'+l.image+'" /><input type="hidden" name="'+d+'" value="'+l.image_id+'" /><a class="delete-uploaded" data-fileid="'+l.image_id+'" href="#" title="'+nooUpload.remove_txt+'"><i class="fa fa-times-circle"></i></a></div>'):o.append('<div class="image-upload-thumb"><img width="150" src="'+l.image+'" /><input type="hidden" name="'+d+'[]" value="'+l.image_id+'" /><a class="delete-uploaded" data-fileid="'+l.image_id+'" href="#" title="'+nooUpload.remove_txt+'"><i class="fa fa-times-circle"></i></a></div>')}}}});t.init(),o.on("click",".image-upload-thumb .delete-uploaded",function(e){e.preventDefault();var a=u(this);a.parent(".image-upload-thumb").remove();var i={attach_id:a.data("fileid")};return u.post(nooUpload.delete_url,i),a.closest(".upload-preview-wrap").find(".noo-upload-value").val(),!1})}}(jQuery);